# Laboratory - MITRE: ATT&CK

## Task 1
Choose a publicly known security breach that has happened in the past. Where possible, find more than one source of reporting information.

## Development
### Equifax Data Breach
Summary<br/>
The Equifax data breach occurred between May and July 2017 at the American credit bureau Equifax. Private records of 147.9 million Americans, along with 15.2 million British citizens and approximately 19,000 Canadian citizens, were compromised in the breach, making it one of the largest cybercrimes related to identity theft. In a settlement with the United States Federal Trade Commission, Equifax offered affected users settlement funds and free credit monitoring. (The Wall Street Journal, 2020)<br/>
Credit reporting agency Equifax has reached a deal to pay up to 700 million to state and federal regulators to settle probes stemming from a data breach that exposed the personal information of nearly 150 million people. It will be the largest settlement ever paid for a data breach. The Federal Trade Commission announced Monday that Equifax will pay at least 300 million and as much as 425 million to compensate affected people with credit monitoring services. (CNN, 2019)<br/>
In September 2017, Equifax, a major credit ratings company, revealed a massive cyberattack where the personal data of over 140 million individuals, nearly half of the U.S. population, was stolen. This incident became a significant consumer data security scandal, involving the theft of sensitive information such as Social Security numbers, driver's license numbers, and credit dispute details. As a result, CEO Richard Smith resigned amidst criticism, and lawmakers implemented changes to credit freeze laws and introduced new regulatory oversight for credit ratings agencies. However, an unusual development occurred when the stolen data completely disappeared. (CNBC, 2019)

## Task 2
Using the MITRE: ATT&CK framework, identify all the various techniques that were used in the breach by their MITRE: ATT&CK Identification Number (ID) and Name.

### Reconnaissance
Vulnerability Scanning (T1595.002): Adversaries usually carry out vulnerability scans on potential targets to identify weaknesses they can exploit. In these scans, adversaries could have found some issues in the target's configuration, such as its software and version, to see if it matches known vulnerabilities. The fact that these vulnerability scans are time-consuming suggests that the identified vulnerabilities may have been present in the target's system for an extended period. This extended presence allows adversaries ample time to discover the vulnerability, assess its potential for exploitation, and devise a plan to carry out their attack.
### Initial Access
Exploit Public-Facing Application (T1190): Adversaries might try to take advantage of a vulnerability in a system or host exposed. These targeted applications are commonly web servers, websites, and databases. In this case, the vulnerability that was exploited was the ‘Apache Struts vulnerability’. Struts is vulnerable to remote command injection attacks by sending an invalid Content-Type HTTP header. This vulnerability allows these commands to be executed under the privileges of the Web server. This is full remote command execution and has been actively exploited in the wild since the initial disclosure.
### Persistence
Server Software Component (T1505): Adversaries can exploit misconfigured servers to maintain persistent access to systems. Application servers often include features that enable the writing and execution of scripts to modify the primary application's functionality. In this instance, a Web Shell was employed to establish and maintain access to systems. A Web Shell is a script located on a publicly accessible web server that adversaries use to gain entry into the network. Once inside, it provides access to the server's command-line interface, granting the attacker control over the system.
### Lateral Movement
Latreal Tool Transfer (T1570): Attackers can move tools or files between systems within a compromised environment. After being introduced to the victim's environment, these files can be duplicated from one system to another to set up attacker tools or other files throughout an operation. In this case, Adversaries remotely copied files from the attacker-controlled server to the Equifax web servers via web shells.
### Privilege escalation
Valid Accounts (T1078): Attackers can use stolen credentials to initially enter a system, maintain access, gain more privileges, or avoid detection. These credentials help them bypass security controls on network resources and maintain access to external services and remote systems. In this case, after gaining initial access to Equifax's web servers, attackers conducted reconnaissance and discovered additional account usernames and passwords. These credentials granted them further access to other back-end Equifax databases.
### Collection
Data from information repositories (T1213): Attackers might use information repositories to extract valuable data. These repositories can contain diverse information that can assist attackers in achieving their goals or provide direct access to the specific data they are targeting. In this case, after the installation of web shells in the Apache web server, the attackers proceeded to execute more than 9,000 SQL commands on an Equifax SQL server located in the backend. In the initial stages of their reconnaissance, the attackers began by querying multiple databases to ascertain their contents.
### Command and control
Application Layer Protocol (T1071): Adversaries utilize OSI application layer protocols to remain undetected within network traffic, effectively blending in. They hide their commands to the remote system and often the subsequent results within the protocol traffic between the client and server. In this case, Attackers used encrypted login protocols and SSH to conceal their communications within commonly used encrypted channels. They further obscured their access to the Equifax online dispute portal by leveraging existing encrypted communication channels within Equifax's network, making their activities appear as normal network activity.

## Task 3
Describe what other organizations could learn from this breach to help them detect these types of issues in the future.

All organizations that have servers exposed to the internet, whether they are information storage servers, application repositories, databases, and others, should view the Equifax case as a lesson in overconfidence. Simply having 'powerful' and modern equipment is not enough for protection; what is crucial is how well these devices are configured, whether they are firewalls, routers, switches, servers, or any other equipment, as they all have features that can be configured to provide an additional layer of security. Financial entities such as banks, insurance companies, or investment firms are subject to public scrutiny and can easily be selected as targets. They require specialized teams dedicated to data traffic and threat analysis. Data analytics or data storage entities are also a common target since they often possess confidential information, which can be used for various types of crimes.<br/>
Any threat can be detected in time with the right team and budget. A Security Operations Center (SOC) or a Network Operations Center (NOC) is essential for prevention and analysis execution. However, not all organizations are willing to invest in a complete cybersecurity team, so they can acquire the services of third parties, which act as intermediaries and specialize in cybersecurity.<br/>
Personally, I believe that every organization should have a specialized information security team, as information can be considered one of the most valuable assets of the organization, especially when dealing with sensitive and/or confidential information. It may not be a small investment, but conducting a proper risk analysis may reveal that the cost of maintaining a security team is lower than the cost of losing the trust and reputation of customers, in addition to potential penalties for mishandling information. Therefore, it is recommended to:
  - Conduct a risk and threat analysis.
  - Implement proven standards and regulations to secure information (NIST / ISO 27001).
  - Hire qualified personnel for NOC and SOC operations.


